@using ToDoList_Front.Clients
@inject ItemsClient ItemsClient
@inject HistoryClient HistoryClient

<div class="add-task">
    <input class="add-task-input" @bind="ItemText" type="text" placeholder="Enter a task..." />
    <button class="add-task-button" @onclick="Create">Add</button>
</div>

@code {
    private string ItemText { get; set; } = string.Empty;
    
    [Parameter] public EventCallback OnItemAdded { get; set; }

    private async Task Create()
    {
        if (!string.IsNullOrWhiteSpace(ItemText))
        {
            ItemDto newItem = new ItemDto(ItemText, false, null);
            await ItemsClient.CreateItem(newItem);
            await OnItemAdded.InvokeAsync();
            await HistoryClient.CreateHistory(new HistoryDto(ItemText, $"Task \"{ItemText}\" has been created."));
            ItemText = string.Empty;
        }
    }
}